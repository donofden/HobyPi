<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Pi Camera – Control Panel</title>
    <link rel="icon" type="image/svg+xml" href="/ui/favicon.svg" />
    <link rel="stylesheet" href="/ui/styles.css" />
    <script defer src="/ui/app.js"></script>
    <script defer src="/ui/share-modal.js"></script>
  </head>
  <body>
    <main>
      <section class="card preview">
        <div class="timestamp-overlay" id="timestamp-overlay"></div>
        <img id="view" src="stream.mjpg" alt="MJPEG Stream" />
      </section>

      <aside class="card sidebar">
        <accordion-section>
          <details open>
            <summary><span class="label">Status</span></summary>
            <div class="status-pills">
              <div class="pill"><span class="pill-label">name</span><span class="pill-value" id="st_name">-</span></div>
              <div class="pill"><span class="pill-label">running</span><span class="pill-value" id="st_run">false</span></div>
              <div class="pill"><span class="pill-label">paused</span><span class="pill-value" id="st_pause">false</span></div>
              <div class="pill"><span class="pill-label">rec</span><span class="pill-value" id="st_rec">off</span></div>
              <div class="pill"><span class="pill-label">flip</span><span class="pill-value" id="st_flip">h:off v:off</span></div>
              <div class="pill"><span class="pill-label">config</span><span class="pill-value" id="st_cfg">-</span></div>
              <div class="pill"><span class="pill-label">op</span><span class="pill-value" id="st_op">idle</span></div>
            </div>
            <div class="toggle">
              <input type="checkbox" id="auto-refresh" checked />
              <label for="auto-refresh">Auto refresh status &amp; logs</label>
            </div>
          </details>
        </accordion-section>

        <accordion-section>
          <details open>
            <summary><span class="label">Live Controls</span></summary>
            <div class="button-group" data-group="lifecycle">
              <button data-action="start">Start</button>
              <button data-action="pause">Pause</button>
              <button data-action="resume">Resume</button>
              <button data-action="stop">Stop</button>
            </div>
            <div class="button-group" data-group="flip">
              <button data-flip="h">Flip H</button>
              <button data-flip="v">Flip V</button>
              <button data-flip="none">Reset flip</button>
            </div>
          </details>
        </accordion-section>

        <accordion-section>
          <details>
            <summary><span class="label">Advanced Controls</span></summary>
            <div class="toggle">
              <input type="checkbox" id="toggle-overlay" />
              <label for="toggle-overlay">Show timestamp overlay</label>
            </div>

            <div class="field-group">
              <label>Focus Mode</label>
              <div class="button-group" data-group="focus">
                <button data-focus-mode="auto">Auto</button>
                <button data-focus-mode="continuous">Continuous</button>
                <button data-focus-mode="manual">Manual</button>
              </div>
              <div class="field-inline" id="focus-manual">
                <label for="focus-position">Lens</label>
                <input type="range" id="focus-position" min="0" max="10" step="0.1" value="5" />
                <span id="focus-position-value">5.0</span>
                <button id="btn-focus-apply">Apply Manual Focus</button>
              </div>
            </div>

            <div class="field-group">
              <label for="zoom-slider">Zoom</label>
              <div class="field-inline">
                <input type="range" id="zoom-slider" min="1" max="4" step="0.1" value="1" />
                <span id="zoom-value">1.0×</span>
                <button id="btn-zoom-apply">Apply Zoom</button>
              </div>
            </div>

            <div class="field-group">
              <label>Metadata</label>
              <div class="button-group" data-group="metadata">
                <button id="btn-fetch-metadata">Fetch Metadata</button>
              </div>
              <pre id="metadata-view">-</pre>
            </div>
          </details>
        </accordion-section>

        <accordion-section>
          <details>
            <summary><span class="label">Configuration</span></summary>
            <div class="field-group">
              <label for="preset">Resolution Presets</label>
              <select id="preset">
                <option>1280x720@30</option>
                <option>1920x1080@30</option>
                <option>1640x1232@30</option>
                <option>640x480@30</option>
              </select>
            </div>
            <div class="field-group">
              <label>Custom Dimensions</label>
              <div class="field-inline">
                <input type="number" id="w" value="1280" min="64" />
                <span>×</span>
                <input type="number" id="h" value="720" min="64" />
                <span>@</span>
                <input type="number" id="fps" value="30" min="1" />
                <span>fps</span>
              </div>
            </div>
            <div class="field-group">
              <label for="q">JPEG Quality</label>
              <div class="field-inline">
                <input type="number" id="q" value="80" min="10" max="100" />
                <button id="btn-apply-config">Apply</button>
              </div>
            </div>
          </details>
        </accordion-section>

        <accordion-section>
          <details>
            <summary><span class="label">Quality &amp; Performance</span></summary>
            <div class="toggle">
              <input type="checkbox" id="toggle-ae" checked />
              <label for="toggle-ae">Auto exposure</label>
            </div>
            <div class="toggle">
              <input type="checkbox" id="toggle-awb" checked />
              <label for="toggle-awb">Auto white balance</label>
            </div>
            <div class="field-group" id="manual-quality">
              <label>Manual overrides</label>
              <div class="field-inline">
                <label for="exposure-input">Exposure (µs)</label>
                <input type="number" id="exposure-input" value="10000" min="100" step="100" />
                <label for="gain-input">Analogue gain</label>
                <input type="number" id="gain-input" value="1.0" min="1" step="0.1" />
                <button id="btn-apply-quality">Apply</button>
              </div>
            </div>
          </details>
        </accordion-section>

        <accordion-section>
          <details>
            <summary><span class="label">Snapshots</span><span class="count" id="count-snaps">0</span></summary>
            <div class="button-group" data-group="snapshots">
              <button id="btn-snapshot">Capture Snapshot</button>
              <button id="btn-clear-snaps">Clear Snapshots</button>
            </div>
            <div id="snaps"><small>None.</small></div>
          </details>
        </accordion-section>

        <accordion-section>
          <details>
            <summary><span class="label">Recording</span><span class="count" id="count-vids">0</span></summary>
            <div class="button-group" data-group="recording">
              <button data-record="start">Start Recording</button>
              <button data-record="stop">Stop Recording</button>
              <button id="btn-clear-videos">Clear Videos</button>
            </div>
            <div id="vids"><small>None.</small></div>
          </details>
        </accordion-section>

        <accordion-section>
          <details>
            <summary><span class="label">Logs</span></summary>
            <div class="button-group" data-group="logs">
              <button id="btn-refresh-logs">Refresh Logs</button>
            </div>
            <div id="logs"></div>
          </details>
        </accordion-section>
      </aside>
    </main>
  </body>
</html>
